## 有标号有（无）根树计数的 EGF 推导

借助 Prufer 序列，容易知道 $n$ 个点的有标号无根树有 $n ^ {n - 2}$ 种，而有根树就选一个根，即再乘一个 $n$，有 $n ^ {n - 1}$ 种。

这里给出一种用 EGF 的推导方式：

考虑有根树，设 $\hat{F}(z)$ 是答案的 EGF 。根的子树森林相当于是一堆树的拼插，根据 $\exp$ 的组合意义，容易得到它的子树森林共有 $\exp(\hat{F}(z))$ 种，算上它自己，便可以得到关于 $\hat{F}(z)$ 的方程：

$$
\hat{F}(z)=z\exp(\hat{F}(z))
$$

可以利用这个式子直接牛顿迭代 $\mathcal{O}(n \log n)$ 计算答案，但这里，我们继续推下去。

把方程整理一下：

$$
\frac{\hat{F}(z)}{\exp(\hat{F}(z))} = z
$$

设 $G(y) = \frac{y}{\exp(y)}$ ，那么 $G(\hat{F}(z)) = z$。

写出 $f(x) = xe ^ {-x}$ 的泰勒展开式，发现它的常数项为 $0$ ，一次项系数非 $0$, 符合拉格朗日反演的条件，直接上公式：

$$
\[z^n\]\hat{F}(z) = \frac{1}{n}\[z ^ {n - 1}\](\frac{z}{G(z)}) ^ {n} = \frac{1}{n}\[z ^ {n - 1}\]\exp(z) ^ {n} = \frac{1}{n}\[z ^ {n - 1}\]\exp(nz) = n ^ {n - 1}
$$

与 Prufer 序列推出的结果是一样的。类似地，无根树除一个 $n$ 即可。

## $n$ 个有标号的节点组成 $k$ 棵有根树
方案数是：
$$
\binom{n-1}{k-1}n^{n-k}
$$
理解可以是在有根树的 $\operatorname{Prüfer}$ 序列上（yy 的名字，就是在最后加上一个根）挖掉 $k-1$ 个位置，让应当在这里连边的元素不再连边。

## $n$ 个有标号的节点组成 $k$ 棵已经选定了根的树
方案数是：
$$
k\times n^{n-k-1}
$$
证明直接对上面的公式进行吸收恒等式的变换。

[证明](https://blog.csdn.net/S1766434333/article/details/103708446)可以参考这个连接，可能定义上有点小问题。

